<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>NAS Shared Drives Review Portal</title>

    <!-- FONTS & ICONS -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link rel="icon" href="asset/nab.ico" />
    <link rel="stylesheet" href="./css/styles.css" />
  </head>

  <body>
    <!-- === HEADER / BANNER === -->
    <header class="top-banner">
      <div class="left">
        <img src="asset/logo.png" alt="Logo" class="logo" />
        <div class="banner-title-group">
          <h1 class="banner-title">NAS Shared Drives Review Portal</h1>
          <div class="subtitle">
            Self-check if your share is ready to migrate, or identify blockers
            to resolve beforehand.<br />
            Visit
            <a
              class="link"
              href="https://nabcts.sharepoint.com/sites/NAStoSPOMigration"
              target="_blank"
              >NAS to SPO Project Site</a
            >
            for full guidance.
          </div>
        </div>
      </div>
    </header>

    <main class="container">
      <!-- === SECTION 1: Before You Scan === -->
      <section class="pre-scan">
        <h2>1️⃣ Before You Scan</h2>
        <ul class="checklist">
          <li>✅ Runs entirely in your browser — no file upload to server.</li>
          <li>✅ Large files (50–100 MB) may take up to 20 s to process.</li>
          <li>✅ Password-protected or encrypted files can’t be scanned.</li>
          <li>✅ Binary formats (.xls, .doc, .ppt) have limited accuracy.</li>
        </ul>
        <label class="acknowledge">
          <input type="checkbox" id="acknowledgeGuidance" />
          I understand and want to start scanning
        </label>
      </section>

      <!-- === SECTION 2: Upload & Controls === -->
      <section class="upload">
        <h2>2️⃣ Upload Your Files</h2>
        <div id="dropzone" class="dropzone">
          Drop files here or
          <button id="chooseFilesBtn" class="btn">Choose Files</button>
        </div>
        <input
          id="fileInput"
          type="file"
          accept=".xlsm,.xlsb,.docm,.pptm"
          multiple
          hidden
        />
        <p class="note">
          Accepted: .xlsm .xlsb .docm .pptm – max 10 files / 100 MB each
        </p>
        <div id="selectedList" class="selected-list"></div>

        <div class="controls">
          <button id="scanBtn" class="btn primary" disabled>
            <i class="fa-solid fa-play"></i> Start Scan
          </button>
          <button id="resetBtn" class="btn" disabled>
            <i class="fa-solid fa-rotate-right"></i> Start Over
          </button>
          <button id="exportBtn" class="btn" disabled>
            <i class="fa-solid fa-file-csv"></i> Export CSV
          </button>
        </div>

        <!-- progress bar -->
        <div id="progressPanel" class="progress-panel" hidden>
          <div class="progress-bar-wrap">
            <div id="progressBar" class="progress-bar">
              <span id="progressPct">0%</span>
            </div>
          </div>
          <div class="progress-meta">
            <span id="currentFile">–</span> |
            <span id="elapsed">0 s</span> |
            Detections: <span id="detectionCount">0</span>
          </div>
        </div>
      </section>

      <!-- === SECTION 3: Scan Results === -->
      <section id="results" class="results" hidden>
        <h2>3️⃣ Scan Results</h2>
        <div id="statusMessage" class="status-message"></div>

        <!-- SUMMARY TABLE -->
        <table class="summary-table">
          <thead>
            <tr>
              <th>File Name</th>
              <th>NAS Path Found</th>
              <th>UNC Path Found</th>
              <th>Password Protected</th>
              <th>Other Issues</th>
            </tr>
          </thead>
          <tbody id="summaryBody"></tbody>
        </table>

        <!-- DETAILED RESULTS -->
        <details open>
          <summary>NAS Shared Drive Paths <span id="nasCount">(0)</span></summary>
          <div class="result-table-wrap">
            <table id="nasTable" class="result-table">
              <thead>
                <tr>
                  <th>File</th>
                  <th>Section</th>
                  <th>Path</th>
                  <th>Usage</th>
                  <th>Impact</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </details>

        <details open>
          <summary>
            Other Hard-coded Paths <span id="otherCount">(0)</span>
          </summary>
          <div class="result-table-wrap">
            <table id="otherTable" class="result-table">
              <thead>
                <tr>
                  <th>File</th>
                  <th>Section</th>
                  <th>Path</th>
                  <th>Usage</th>
                  <th>Impact</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </details>

        <details>
          <summary>
            Protected or Encrypted Files <span id="protectedCount">(0)</span>
          </summary>
          <div id="protectedList" class="protected-list"></div>
        </details>
      </section>
    </main>

    <footer class="footer">
      <small>National Australia Bank — Private & Confidential</small>
    </footer>

    <!-- LIBRARIES -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script src="./js/vba-extractor.js"></script>
    <script src="./js/script.js"></script>
  </body>
</html>
